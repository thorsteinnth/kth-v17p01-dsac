{"paragraphs":[{"text":"%md\n\n### From Best Effort to Causal Order Reliable Broadcast\n\nThis is the first programming assignment where you will have to build and reuse multiple components. \nStarting bottom-up, you will first have to implement *best effort broadcast*, then *reliable broadcast* and finally *causal order reliable broadcast*.\nMind that passing each component check will give you a **partial** grade (1 point)  and therefore you will need to pass **all** checks to get the full grade (3 points) for this programming assignment.\n\nThis time you simply have to export your notebook when done and just upload it in the \"Programming Exercise 3\" page.\n\n**Things to Remember**:\n1. Some components such as `PerfectLink`,  `Network` and `Timer` are already provided. No need to implement them.\n2. Execute the imports defined below **before** compiling your component implementations.\n3. We recommend making use of the component state and internal messages we have provided, if any, to complete the implementation logic.\n4. You can always print messages to the output log, from within handlers to see what happens during the simulation. e.g. `println(s\"Process $self delivers message $msg\");`\n5. Remember that during the simulation check you can print and observe the simulation time, i.e. with `System.currentTimeMillis()`.\n5. Do not forget to run the checker code block after each component implementation to ensure that all properties are satisfied **before** exporting and submitting the notebook.\n6. You can always restart the Kompics Interpreter to start fresh (Interpreter→KompicsInterpreter→Click Restart)\n\nGood luck! :)","dateUpdated":"2017-02-14T12:05:31+0000","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1487073931493_794058785","id":"20160915-144724_1712226433","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>From Best Effort to Causal Order Reliable Broadcast</h3>\n<p>This is the first programming assignment where you will have to build and reuse multiple components.\n<br  />Starting bottom-up, you will first have to implement <em>best effort broadcast</em>, then <em>reliable broadcast</em> and finally <em>causal order reliable broadcast</em>.\n<br  />Mind that passing each component check will give you a <strong>partial</strong> grade (1 point)  and therefore you will need to pass <strong>all</strong> checks to get the full grade (3 points) for this programming assignment.</p>\n<p>This time you simply have to export your notebook when done and just upload it in the &ldquo;Programming Exercise 3&rdquo; page.</p>\n<p><strong>Things to Remember</strong>:</p>\n<ol>\n<li>Some components such as <code>PerfectLink</code>,  <code>Network</code> and <code>Timer</code> are already provided. No need to implement them.</li>\n<li>Execute the imports defined below <strong>before</strong> compiling your component implementations.</li>\n<li>We recommend making use of the component state and internal messages we have provided, if any, to complete the implementation logic.</li>\n<li>You can always print messages to the output log, from within handlers to see what happens during the simulation. e.g. <code>println(s\"Process $self delivers message $msg\");</code></li>\n<li>Remember that during the simulation check you can print and observe the simulation time, i.e. with <code>System.currentTimeMillis()</code>.</li>\n<li>Do not forget to run the checker code block after each component implementation to ensure that all properties are satisfied <strong>before</strong> exporting and submitting the notebook.</li>\n<li>You can always restart the Kompics Interpreter to start fresh (Interpreter→KompicsInterpreter→Click Restart)</li>\n</ol>\n<p>Good luck! :)</p>\n"},"dateCreated":"2017-02-14T12:05:31+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2110"},{"text":"import se.kth.edx.id2203.core.ExercisePrimitives._\nimport se.kth.edx.id2203.core.Ports._\nimport se.kth.edx.id2203.validation._\nimport se.sics.kompics.network._\nimport se.sics.kompics.sl.{Init, _}\nimport se.sics.kompics.{ComponentDefinition => _, Port => _, KompicsEvent}\n\nimport scala.collection.immutable.Set\nimport scala.collection.mutable.ListBuffer","dateUpdated":"2017-02-14T12:11:55+0000","config":{"enabled":true,"tableHide":false,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","editorHide":false,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1487073931493_794058785","id":"20160728-150612_1687562708","dateCreated":"2017-02-14T12:05:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2111","dateFinished":"2017-02-14T12:11:55+0000","dateStarted":"2017-02-14T12:11:55+0000","result":{"code":"SUCCESS","type":"HTML","msg":"import se.kth.edx.id2203.core.ExercisePrimitives._<br />import se.kth.edx.id2203.core.Ports._<br />import se.kth.edx.id2203.validation._<br />import se.sics.kompics.network._<br />import se.sics.kompics.sl.{Init, _}<br />import se.sics.kompics.{ComponentDefinition=>_, Port=>_, KompicsEvent}<br />import scala.collection.immutable.Set<br />import scala.collection.mutable.ListBuffer<br />"},"focus":true},{"text":"%md\n\n### Part I: Best-Effort Broadcast ###\n\nA Best-Effort Broadcast Abstraction (BEB), in Kompics terms,  is a component that **provides** the following port *(already imported in the notebook)*.\n\n    class BestEffortBroadcast extends Port {\n     indication[BEB_Deliver];\n     request[BEB_Broadcast];\n    }\n\nA **BEB** component should request `BEB_Broadcast` and indicate `BEB_Deliver` events as defined below:\n\n     case class BEB_Deliver(source: Address, payload: KompicsEvent) extends KompicsEvent;\n     case class BEB_Broadcast(payload: KompicsEvent) extends KompicsEvent;\n\n\nAs you have already learnt from the course lectures, Best-Effort Broadcast should satisfy the following properties:\n\n1. **Validity**:  *If a correct process broadcasts a message m, then every correct process eventually delivers m.*\n2. **No duplication**: *No message is delivered more than once.*\n3. **No creation**: *If a process delivers a message m with sender s, then m was previously broadcast by process s.*\n\nHINT: The recommended algorithm to use in this assignment is *Basic Broadcast* and is described in the following  [document](https://d37djvu3ytnwxt.cloudfront.net/assets/courseware/v1/a91e7d1ac75367325c1efd101a9e2138/asset-v1:KTHx+ID2203.1x+2016T3+type@asset+block/basicbroadcast.pdf) in the respective lecture.\n","dateUpdated":"2017-02-14T12:05:31+0000","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/markdown","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1487073931493_794058785","id":"20160915-145354_1020037731","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>Part I: Best-Effort Broadcast</h3>\n<p>A Best-Effort Broadcast Abstraction (BEB), in Kompics terms,  is a component that <strong>provides</strong> the following port <em>(already imported in the notebook)</em>.</p>\n<pre><code>class BestEffortBroadcast extends Port {\n indication[BEB_Deliver];\n request[BEB_Broadcast];\n}\n</code></pre>\n<p>A <strong>BEB</strong> component should request <code>BEB_Broadcast</code> and indicate <code>BEB_Deliver</code> events as defined below:</p>\n<pre><code> case class BEB_Deliver(source: Address, payload: KompicsEvent) extends KompicsEvent;\n case class BEB_Broadcast(payload: KompicsEvent) extends KompicsEvent;\n</code></pre>\n<p>As you have already learnt from the course lectures, Best-Effort Broadcast should satisfy the following properties:</p>\n<ol>\n<li><strong>Validity</strong>:  <em>If a correct process broadcasts a message m, then every correct process eventually delivers m.</em></li>\n<li><strong>No duplication</strong>: <em>No message is delivered more than once.</em></li>\n<li><strong>No creation</strong>: <em>If a process delivers a message m with sender s, then m was previously broadcast by process s.</em></li>\n</ol>\n<p>HINT: The recommended algorithm to use in this assignment is <em>Basic Broadcast</em> and is described in the following  <a href=\"https://d37djvu3ytnwxt.cloudfront.net/assets/courseware/v1/a91e7d1ac75367325c1efd101a9e2138/asset-v1:KTHx+ID2203.1x+2016T3+type@asset+block/basicbroadcast.pdf\">document</a> in the respective lecture.</p>\n"},"dateCreated":"2017-02-14T12:05:31+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2112"},{"text":"\nclass BasicBroadcast(init: Init[BasicBroadcast]) extends ComponentDefinition {\n\n  //subscriptions\n  val pLink = requires[PerfectLink];\n  val beb = provides[BestEffortBroadcast];\n\n  //configuration\n  val (self, topology) = init match {\n    case Init(s: Address, t: Set[Address]@unchecked) => (s, t)\n  };\n\n  //handlers\n  beb uponEvent {\n    case x: BEB_Broadcast => handle {\n     \n     /* MY CODE HERE  */\n     // This is an outgoing broadcast\n     // i.e. I got a broadcast request from my application (beb)\n     // Send message to all known processes (via perfect link)\n      for (p <- topology) {\n        trigger(PL_Send(p, x) -> pLink);\n      }\n     \n    }\n  }\n\n  pLink uponEvent {\n    case PL_Deliver(src, BEB_Broadcast(payload)) => handle {\n     \n     /* MY CODE HERE  */\n     // Got this message from someone else (via perfect link)\n     // Should deliver this message (payload) to my application (beb)\n     trigger(BEB_Deliver(src, payload) -> beb);\n     \n    }\n  }\n}","dateUpdated":"2017-02-14T12:37:33+0000","config":{"enabled":true,"tableHide":false,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","editorHide":false,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1487073931494_795213031","id":"20160728-150736_1548510044","dateCreated":"2017-02-14T12:05:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2113","dateFinished":"2017-02-14T12:37:34+0000","dateStarted":"2017-02-14T12:37:33+0000","result":{"code":"SUCCESS","type":"HTML","msg":"defined class BasicBroadcast<br />"},"focus":true},{"text":"checkBEB[BasicBroadcast]();","dateUpdated":"2017-02-14T12:37:37+0000","config":{"enabled":true,"tableHide":false,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","editorHide":false,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1487073931494_795213031","id":"20160830-154208_1529541172","dateCreated":"2017-02-14T12:05:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2114","dateFinished":"2017-02-14T12:37:39+0000","dateStarted":"2017-02-14T12:37:37+0000","result":{"code":"SUCCESS","type":"HTML","msg":"<br />Your submission has been locally simulated and validated.<br /><br /><a href=\"\\static\\log.txt\" target=\"_blank\">Click Here</a> to view the output of the simulation.<br /><style type=\"text/css\">.tg  {border-collapse:collapse;border-spacing:0;border-color:#aabcfe;}.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:#aabcfe;color:#669;background-color:#e8edff;}.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:#aabcfe;color:#039;background-color:#b9c9fe;}.tg .tg-mb3i{background-color:#D2E4FC;text-align:right;vertical-align:top}.tg .tg-lqy6{text-align:right;vertical-align:top}.tg .tg-vlnx{background-color:#3071a9;color:#ffffff;text-align:center;vertical-align:top}.tg .tg-6k2t{background-color:#D2E4FC;vertical-align:top}.tg tg-6k2l{background-color:#ffb3b3;vertical-align:top}.tg .tg-yw4l{vertical-align:top}</style><table class=\"tg\">  <tr>    <th class=\"tg-vlnx\" colspan=\"3\">Correction Results</th>  </tr><br /><tr>    <td class=\"tg-6k2t\">PASSED</td> <td class=\"tg-6k2t\">Validity</td> <td class=\"tg-6k2t\">✔:  Eventually every correct process delivers every message broadcasted by correct processes<br></td>  </tr>  <br /><tr>    <td class=\"tg-6k2t\">PASSED</td> <td class=\"tg-6k2t\">No Duplication-No Creation</td> <td class=\"tg-6k2t\">✔: Every message delivered has been previously broadcasted<br>✔: No duplicate delivered messages found<br></td>  </tr>  <br /></table><br />Final Comments<br />**************<br />Congratulations! Your implementation of the 'Best Effort Broadcast' satisfies all properties! <br />A unique token has been generated for your submission right below. Please do not edit. <br /><br />{\"gradingToken\":[45,45,45,45,45,66,69,71,73,78,32,80,71,80,32,77,69,83,83,65,71,69,45,45,45,45,45,10,86,101,114,115,105,111,110,58,32,66,67,80,71,32,118,49,46,53,53,10,10,104,81,73,77,65,57,79,116,77,118,84,69,98,74,49,102,65,81,47,47,101,119,117,83,77,100,79,120,104,50,116,86,98,71,67,85,71,65,108,114,119,120,56,90,118,85,114,107,109,100,121,49,119,57,72,71,47,65,115,103,83,97,118,78,10,76,101,70,116,68,104,81,55,88,106,70,102,114,103,99,73,103,81,87,111,56,118,68,120,99,75,73,69,55,69,49,55,85,100,43,97,89,68,76,103,107,115,68,100,119,76,103,69,98,122,106,67,52,104,114,69,120,118,87,105,81,56,84,54,10,72,109,88,83,82,70,79,57,120,100,57,113,115,109,54,100,121,107,99,87,101,107,110,87,65,114,97,116,88,105,108,47,55,47,85,79,86,70,69,49,79,67,114,53,101,105,70,84,85,70,53,43,78,79,121,122,75,121,50,85,107,105,76,74,10,119,49,110,118,120,47,71,117,103,81,109,114,51,79,69,71,106,115,107,86,115,108,50,50,80,49,69,99,118,80,107,74,66,71,47,116,75,113,111,82,82,107,101,117,65,104,101,118,100,105,47,69,109,98,43,77,51,104,54,89,102,81,53,102,10,86,76,97,118,103,48,98,121,104,80,56,70,90,43,122,110,70,68,78,71,52,99,71,43,118,73,80,52,66,49,77,117,71,105,97,87,76,84,55,97,99,66,53,74,72,100,87,79,86,102,90,72,82,99,101,52,116,47,86,69,100,100,52,77,10,51,117,102,75,72,52,99,100,98,122,105,68,74,105,53,90,86,50,55,86,98,68,51,83,65,65,54,71,102,86,68,57,89,47,88,87,76,55,43,101,121,120,109,54,118,108,116,52,85,86,105,109,53,74,78,120,101,52,53,85,48,78,111,51,10,52,65,49,110,47,85,53,113,79,117,85,74,118,82,53,65,105,106,76,104,89,89,88,87,98,110,72,49,50,109,103,65,119,82,66,68,55,70,47,86,110,121,112,79,81,105,115,114,99,102,73,122,52,89,102,97,86,52,50,107,70,69,88,50,10,101,77,120,104,78,121,111,105,43,47,102,47,105,74,106,86,69,51,80,55,56,79,74,48,71,99,98,122,73,115,67,56,112,70,51,90,81,84,77,105,69,98,117,55,55,85,103,70,75,112,72,68,73,76,90,75,68,109,89,119,73,69,121,114,10,107,87,84,87,102,97,105,80,50,43,74,110,121,107,87,48,115,121,72,114,99,75,79,121,105,105,90,73,115,108,107,82,80,115,70,110,102,108,117,79,119,47,119,77,49,88,106,122,115,77,85,99,107,90,99,74,84,55,108,100,65,109,50,50,10,52,120,47,109,121,78,55,71,103,49,79,111,122,81,121,78,54,114,109,122,80,79,102,65,53,87,86,120,56,120,47,71,119,105,115,47,78,53,56,105,50,77,104,76,121,71,78,75,85,69,69,103,84,66,107,56,107,80,113,120,69,85,72,86,10,108,76,47,75,97,80,50,83,80,75,119,73,67,50,111,101,100,99,102,51,109,76,82,98,99,78,104,68,101,47,87,105,115,56,78,82,114,65,105,113,121,109,48,89,106,105,88,53,117,86,116,110,54,103,77,110,89,104,111,81,110,78,84,83,10,119,65,48,66,80,119,99,107,78,48,65,80,76,85,105,90,80,65,72,86,86,51,104,69,115,48,105,77,72,56,109,76,119,122,104,76,71,85,69,90,118,121,56,109,74,72,83,99,115,115,104,57,110,50,81,109,81,50,56,120,72,79,107,77,10,78,111,106,74,77,88,81,81,84,89,80,86,102,99,107,90,108,75,57,83,49,90,83,79,52,113,113,71,84,78,101,50,122,113,104,102,54,117,74,99,115,81,109,75,107,84,47,85,49,112,69,119,118,104,65,99,106,108,73,109,77,57,84,54,10,75,72,115,47,73,117,70,49,116,116,85,114,98,112,54,104,109,47,80,47,56,103,114,53,68,80,105,78,99,73,82,82,57,54,116,74,57,65,88,89,56,108,100,113,75,88,81,118,109,98,109,81,54,65,53,55,103,80,71,119,97,69,101,70,10,110,118,97,49,75,57,65,69,57,120,114,111,113,49,76,52,56,79,98,49,49,89,102,52,88,103,115,55,99,110,117,69,50,114,43,76,52,79,90,57,80,47,117,68,52,57,119,84,57,86,107,82,50,90,102,104,73,103,54,78,53,121,119,79,10,50,107,89,84,99,43,120,47,107,76,75,80,85,68,43,43,70,110,100,82,10,61,116,120,120,56,10,45,45,45,45,45,69,78,68,32,80,71,80,32,77,69,83,83,65,71,69,45,45,45,45,45,10]}<br />"},"focus":true},{"text":"%md\n\n### Part II: Reliable Broadcast ###\n\nA Reliable Broadcast Abstraction (RB), in Kompics terms,  is a component that **provides** the following port *(already imported in the notebook)*.\n\n    class ReliableBroadcast extends Port {\n      indication[RB_Deliver];\n      request[RB_Broadcast];\n    }\n    \nAn **RB** component should request `RB_Broadcast` and indicate `RB_Deliver` events, as defined below:\n\n    case class RB_Deliver(source: Address, payload: KompicsEvent) extends KompicsEvent;\n    case class RB_Broadcast(payload: KompicsEvent) extends KompicsEvent;\n       \n\nAs you have already learnt from the course lectures, Reliable Broadcast adds the `Agreement` property into the already existing properties of Best-Effort Broadcast:\n\n1. Validity:  *If a correct process broadcasts a message m, then every correct process eventually delivers m.*\n2. No duplication: *No message is delivered more than once.*\n3. No creation: *If a process delivers a message m with sender s, then m was previously broadcast by process s.*\n4. **Agreement**: *If a message m is delivered by some correct process, then m is eventually delivered by every correct process.*\n\nHINT: The recommended algorithm to use in this assignment is *Eager Reliable Broadcast* and is described in page 2 within the following  [document](https://d37djvu3ytnwxt.cloudfront.net/assets/courseware/v1/6c144fd806b3568f6e2c5d7d03e27a29/asset-v1:KTHx+ID2203.1x+2016T3+type@asset+block/reliablebroadcast.pdf) in the respective lecture.\n\n**Mind that, to complete this part, you will first have to implement and test Best-Effort Broadcast, defined above.**","dateUpdated":"2017-02-14T12:05:31+0000","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1487073931494_795213031","id":"20160915-152029_348185262","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>Part II: Reliable Broadcast</h3>\n<p>A Reliable Broadcast Abstraction (RB), in Kompics terms,  is a component that <strong>provides</strong> the following port <em>(already imported in the notebook)</em>.</p>\n<pre><code>class ReliableBroadcast extends Port {\n  indication[RB_Deliver];\n  request[RB_Broadcast];\n}\n</code></pre>\n<p>An <strong>RB</strong> component should request <code>RB_Broadcast</code> and indicate <code>RB_Deliver</code> events, as defined below:</p>\n<pre><code>case class RB_Deliver(source: Address, payload: KompicsEvent) extends KompicsEvent;\ncase class RB_Broadcast(payload: KompicsEvent) extends KompicsEvent;\n</code></pre>\n<p>As you have already learnt from the course lectures, Reliable Broadcast adds the <code>Agreement</code> property into the already existing properties of Best-Effort Broadcast:</p>\n<ol>\n<li>Validity:  <em>If a correct process broadcasts a message m, then every correct process eventually delivers m.</em></li>\n<li>No duplication: <em>No message is delivered more than once.</em></li>\n<li>No creation: <em>If a process delivers a message m with sender s, then m was previously broadcast by process s.</em></li>\n<li><strong>Agreement</strong>: <em>If a message m is delivered by some correct process, then m is eventually delivered by every correct process.</em></li>\n</ol>\n<p>HINT: The recommended algorithm to use in this assignment is <em>Eager Reliable Broadcast</em> and is described in page 2 within the following  <a href=\"https://d37djvu3ytnwxt.cloudfront.net/assets/courseware/v1/6c144fd806b3568f6e2c5d7d03e27a29/asset-v1:KTHx+ID2203.1x+2016T3+type@asset+block/reliablebroadcast.pdf\">document</a> in the respective lecture.</p>\n<p><strong>Mind that, to complete this part, you will first have to implement and test Best-Effort Broadcast, defined above.</strong></p>\n"},"dateCreated":"2017-02-14T12:05:31+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2115"},{"text":"\n//Reliable Broadcast\n\ncase class OriginatedData(src: Address, payload: KompicsEvent) extends KompicsEvent;\n\nclass EagerReliableBroadcast(init: Init[EagerReliableBroadcast]) extends ComponentDefinition {\n  \n  //EagerReliableBroadcast Subscriptions\n  val beb = requires[BestEffortBroadcast];\n  val rb = provides[ReliableBroadcast];\n\n  //EagerReliableBroadcast Component State and Initialization\n  val self = init match {\n    case Init(s: Address) => s\n  };\n  val delivered = collection.mutable.Set[KompicsEvent]();\n\n  //EagerReliableBroadcast Event Handlers\n  rb uponEvent {\n    case x@RB_Broadcast(payload) => handle {\n     \n     /* WRITE YOUR CODE HERE  */\n     \n    }\n  }\n\n  beb uponEvent {\n    case BEB_Deliver(_, data@OriginatedData(origin, payload)) => handle {\n     \n     /* WRITE YOUR CODE HERE  */\n     \n    }\n  }\n}","dateUpdated":"2017-02-14T12:05:31+0000","config":{"enabled":true,"tableHide":false,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","editorHide":false,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1487073931494_795213031","id":"20160728-150932_1018155040","dateCreated":"2017-02-14T12:05:31+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2116"},{"text":"checkRB[BasicBroadcast,EagerReliableBroadcast]();","dateUpdated":"2017-02-14T12:05:31+0000","config":{"enabled":true,"tableHide":false,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","editorHide":false,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1487073931494_795213031","id":"20160830-154553_1603284544","dateCreated":"2017-02-14T12:05:31+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2117"},{"text":"%md\n\n### Part III: Causal-Order Reliable Broadcast ###\n\nA Causal-Order Reliable Broadcast Abstraction (CRB), in Kompics terms,  is a component that **provides** the following port *(already imported in the notebook)*.\n\n    class CausalOrderReliableBroadcast extends Port {\n      indication[CRB_Deliver];\n      request[CRB_Broadcast];\n    }\n       \nA **CRB** component should request `CRB_Broadcast` and indicate `CRB_Deliver` events, as defined below:\n\n    case class CRB_Deliver(src: Address, payload: KompicsEvent) extends KompicsEvent;\n    case class CRB_Broadcast(payload: KompicsEvent) extends KompicsEvent;\n\n\nAs you have already learnt from the course lectures, Causal-Order Reliable Broadcast adds the `Causal Delivery` property into the already existing properties of Reliable and Best-Effort Broadcast:\n\n1. Validity:  *If a correct process broadcasts a message m, then every correct process eventually delivers m.*\n2. No duplication: *No message is delivered more than once.*\n3. No creation: *If a process delivers a message m with sender s, then m was previously broadcast by process s.*\n4. Agreement: *If a message m is delivered by some correct process, then m is eventually delivered by every correct process.*\n5. **Causal delivery**: *For any message m1 that potentially caused a message m2, i.e., m1 → m2, no process delivers m2 unless it has already delivered m1.*\n\nHINT: The recommended algorithm to use in this assignment is *Waiting Causal Broadcast* and is described in page 4 within the following  [document](https://d37djvu3ytnwxt.cloudfront.net/assets/courseware/v1/f11d45d4cb0d9685c723dd00de427b8d/asset-v1:KTHx+ID2203.1x+2016T3+type@asset+block/causalbroadcast.pdf) in the respective lecture.\n\n**Also mind, that to complete this part, you will first have to implement and test Best-Effort Broadcast and Reliable Broadcast, defined above.**\n\n\n####Working with Vector Clocks####\nWe have already provided you a `VectorClock` data structure **(already imported)** to aid you with the algorithm implementation. You can briefly see the supported operations below:\n\n```scala\n    case class VectorClock(var vc: Map[Address, Int]) {\n        def inc(addr: Address) : Unit  //increases the clock corresponding to the address @addr provided\n        def set(addr: Address, value: Int) : Unit //sets the clock of @addr to @value\n        def <=(that: VectorClock): Boolean   //returns true if this vector clock instance is lower or equal to @that\n    }\n    object VectorClock {\n        def empty(topology: scala.Seq[Address]): VectorClock //generates a vector clock that has an initial clock value of 0 for each address in the @topology provided\n        def apply(that: VectorClock): VectorClock //copy constructor of a vector clock. E.g. if vc1 is a vector clock vc2 = VectorClock(vc1) is a copy of vc1\n    }\n```\nIn case you want to check the full implementation of the VectorClock, you can find it in our full published gist [here](https://gist.github.com/senorcarbone/5c960ee27a67ec8b6bd42c33303fdcd2).\n","dateUpdated":"2017-02-14T12:05:31+0000","config":{"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","editorHide":true,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1487073931495_794828283","id":"20160915-154115_478906095","result":{"code":"SUCCESS","type":"HTML","msg":"<h3>Part III: Causal-Order Reliable Broadcast</h3>\n<p>A Causal-Order Reliable Broadcast Abstraction (CRB), in Kompics terms,  is a component that <strong>provides</strong> the following port <em>(already imported in the notebook)</em>.</p>\n<pre><code>class CausalOrderReliableBroadcast extends Port {\n  indication[CRB_Deliver];\n  request[CRB_Broadcast];\n}\n</code></pre>\n<p>A <strong>CRB</strong> component should request <code>CRB_Broadcast</code> and indicate <code>CRB_Deliver</code> events, as defined below:</p>\n<pre><code>case class CRB_Deliver(src: Address, payload: KompicsEvent) extends KompicsEvent;\ncase class CRB_Broadcast(payload: KompicsEvent) extends KompicsEvent;\n</code></pre>\n<p>As you have already learnt from the course lectures, Causal-Order Reliable Broadcast adds the <code>Causal Delivery</code> property into the already existing properties of Reliable and Best-Effort Broadcast:</p>\n<ol>\n<li>Validity:  <em>If a correct process broadcasts a message m, then every correct process eventually delivers m.</em></li>\n<li>No duplication: <em>No message is delivered more than once.</em></li>\n<li>No creation: <em>If a process delivers a message m with sender s, then m was previously broadcast by process s.</em></li>\n<li>Agreement: <em>If a message m is delivered by some correct process, then m is eventually delivered by every correct process.</em></li>\n<li><strong>Causal delivery</strong>: <em>For any message m1 that potentially caused a message m2, i.e., m1 → m2, no process delivers m2 unless it has already delivered m1.</em></li>\n</ol>\n<p>HINT: The recommended algorithm to use in this assignment is <em>Waiting Causal Broadcast</em> and is described in page 4 within the following  <a href=\"https://d37djvu3ytnwxt.cloudfront.net/assets/courseware/v1/f11d45d4cb0d9685c723dd00de427b8d/asset-v1:KTHx+ID2203.1x+2016T3+type@asset+block/causalbroadcast.pdf\">document</a> in the respective lecture.</p>\n<p><strong>Also mind, that to complete this part, you will first have to implement and test Best-Effort Broadcast and Reliable Broadcast, defined above.</strong></p>\n<h4>Working with Vector Clocks</h4>\n<p>We have already provided you a <code>VectorClock</code> data structure <strong>(already imported)</strong> to aid you with the algorithm implementation. You can briefly see the supported operations below:</p>\n<pre><code class=\"scala\">    case class VectorClock(var vc: Map[Address, Int]) {\n        def inc(addr: Address) : Unit  //increases the clock corresponding to the address @addr provided\n        def set(addr: Address, value: Int) : Unit //sets the clock of @addr to @value\n        def &lt;=(that: VectorClock): Boolean   //returns true if this vector clock instance is lower or equal to @that\n    }\n    object VectorClock {\n        def empty(topology: scala.Seq[Address]): VectorClock //generates a vector clock that has an initial clock value of 0 for each address in the @topology provided\n        def apply(that: VectorClock): VectorClock //copy constructor of a vector clock. E.g. if vc1 is a vector clock vc2 = VectorClock(vc1) is a copy of vc1\n    }\n</code></pre>\n<p>In case you want to check the full implementation of the VectorClock, you can find it in our full published gist <a href=\"https://gist.github.com/senorcarbone/5c960ee27a67ec8b6bd42c33303fdcd2\">here</a>.</p>\n"},"dateCreated":"2017-02-14T12:05:31+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2118"},{"text":"\n\n//Causal Reliable Broadcast\n\ncase class DataMessage(timestamp: VectorClock, payload: KompicsEvent) extends KompicsEvent;\n\nclass WaitingCRB(init: Init[WaitingCRB]) extends ComponentDefinition {\n\n  //subscriptions\n  val rb = requires[ReliableBroadcast];\n  val crb = provides[CausalOrderReliableBroadcast];\n\n  //configuration\n  val (self, vec) = init match {\n    case Init(s: Address, t: Set[Address]@unchecked) => (s, VectorClock.empty(t.toSeq))\n  };\n\n  //state\n  var pending: ListBuffer[(Address, DataMessage)] = ListBuffer();\n  var lsn = 0;\n\n\n  //handlers\n  crb uponEvent {\n    case x: CRB_Broadcast => handle {\n     \n     /* WRITE YOUR CODE HERE  */\n     \n    }\n  }\n\n  rb uponEvent {\n    case x@RB_Deliver(src: Address, msg: DataMessage) => handle {\n     \n     /* WRITE YOUR CODE HERE  */\n     \n    }\n  }\n}\n","dateUpdated":"2017-02-14T12:05:31+0000","config":{"enabled":true,"tableHide":false,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","editorHide":false,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1487073931495_794828283","id":"20160728-150719_1155234225","dateCreated":"2017-02-14T12:05:31+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2119"},{"text":"checkCRB[BasicBroadcast, EagerReliableBroadcast, WaitingCRB]();","dateUpdated":"2017-02-14T12:05:31+0000","config":{"enabled":true,"tableHide":false,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","editorHide":false,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1487073931495_794828283","id":"20160728-150824_64351046","dateCreated":"2017-02-14T12:05:31+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2120"},{"dateUpdated":"2017-02-14T12:05:31+0000","config":{"enabled":true,"tableHide":false,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorMode":"ace/mode/scala","editorHide":false,"colWidth":12},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1487073931495_794828283","id":"20160830-154726_1125271335","dateCreated":"2017-02-14T12:05:31+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2121"}],"name":"Exercise: Broadcast Abstractions","id":"2C8JPYDTH","angularObjects":{"2BKQCVH92:shared_process":[],"2BMXUXUJ6:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}